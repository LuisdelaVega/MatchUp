!function(e,o){"undefined"!=typeof module&&module.exports?module.exports=o(require("angular")):"function"==typeof define&&define.amd?define(["angular"],o):o(e.angular)}(this,function(e){"use strict";var o,n=e.module("ngDialog",[]),a=e.element,l=e.isDefined,i=(document.body||document.documentElement).style,t=l(i.animation)||l(i.WebkitAnimation)||l(i.MozAnimation)||l(i.MsAnimation)||l(i.OAnimation),s="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",c=!1;return n.provider("ngDialog",function(){var n=this.defaults={className:"ngdialog-theme-default",plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0};this.setForceBodyReload=function(e){c=e||!1},this.setDefaults=function(o){e.extend(n,o)};var l,i=0,r=0,d={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller",function(g,u,p,m,f,C,D,v,y){var h=g.find("body");c&&C.$on("$locationChangeSuccess",function(){h=g.find("body")});var $={onDocumentKeydown:function(e){27===e.keyCode&&b.close("$escape")},setBodyPadding:function(e){var o=parseInt(h.css("padding-right")||0,10);h.css("padding-right",o+e+"px"),h.data("ng-dialog-original-padding",o)},resetBodyPadding:function(){var e=h.data("ng-dialog-original-padding");e?h.css("padding-right",e+"px"):h.css("padding-right","")},performCloseDialog:function(e,n){var a=e.attr("id");if("undefined"!=typeof v.Hammer){var i=o.hammerTime;i.off("tap",l),i.destroy&&i.destroy(),delete o.hammerTime}else e.unbind("click");1===r&&h.unbind("keydown"),e.hasClass("ngdialog-closing")||(r-=1),C.$broadcast("ngDialog.closing",e),r=0>r?0:r,t?(o.$destroy(),e.unbind(s).bind(s,function(){e.remove(),0===r&&(h.removeClass("ngdialog-open"),$.resetBodyPadding()),C.$broadcast("ngDialog.closed",e)}).addClass("ngdialog-closing")):(o.$destroy(),e.remove(),0===r&&(h.removeClass("ngdialog-open"),$.resetBodyPadding()),C.$broadcast("ngDialog.closed",e)),d[a]&&(d[a].resolve({id:a,value:n,$dialog:e,remainingDialogs:r}),delete d[a])},closeDialog:function(o,n){var a=o.data("$ngDialogPreCloseCallback");if(a&&e.isFunction(a)){var l=a.call(o,n);e.isObject(l)?l.closePromise?l.closePromise.then(function(){$.performCloseDialog(o,n)}):l.then(function(){$.performCloseDialog(o,n)},function(){}):l&&$.performCloseDialog(o,n)}else $.performCloseDialog(o,n)}},b={open:function(t){function s(e,o){return f.get(e,o||{}).then(function(e){return e.data||""})}function c(o){return o?e.isString(o)&&k.plain?o:"boolean"!=typeof k.cache||k.cache?u.get(o)||s(o,{cache:!0}):s(o,{cache:!1}):"Empty template"}var g=this,k=e.copy(n);t=t||{},e.extend(k,t),i+=1,g.latestID="ngdialog"+i;var B;d[g.latestID]=B=m.defer(),o=e.isObject(k.scope)?k.scope.$new():C.$new();var w,S;return m.when(c(k.template||k.templateUrl)).then(function(n){if(u.put(k.template||k.templateUrl,n),k.showClose&&(n+='<div class="ngdialog-close"></div>'),g.$result=w=a('<div id="ngdialog'+i+'" class="ngdialog"></div>'),w.html(k.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content">'+n+"</div>":'<div class="ngdialog-content">'+n+"</div>"),k.data&&e.isString(k.data)){var t=k.data.replace(/^\s*/,"")[0];o.ngDialogData="{"===t||"["===t?e.fromJson(k.data):k.data}else k.data&&e.isObject(k.data)&&(o.ngDialogData=k.data);if(k.controller&&(e.isString(k.controller)||e.isArray(k.controller)||e.isFunction(k.controller))){var s=y(k.controller,{$scope:o,$element:w});w.data("$ngDialogControllerController",s)}if(k.className&&w.addClass(k.className),S=k.appendTo&&e.isString(k.appendTo)?e.element(document.querySelector(k.appendTo)):h,k.preCloseCallback){var c;e.isFunction(k.preCloseCallback)?c=k.preCloseCallback:e.isString(k.preCloseCallback)&&o&&(e.isFunction(o[k.preCloseCallback])?c=o[k.preCloseCallback]:o.$parent&&e.isFunction(o.$parent[k.preCloseCallback])?c=o.$parent[k.preCloseCallback]:C&&e.isFunction(C[k.preCloseCallback])&&(c=C[k.preCloseCallback])),c&&w.data("$ngDialogPreCloseCallback",c)}if(o.closeThisDialog=function(e){$.closeDialog(w,e)},D(function(){p(w)(o);var e=v.innerWidth-h.prop("clientWidth");h.addClass("ngdialog-open");var n=e-(v.innerWidth-h.prop("clientWidth"));n>0&&$.setBodyPadding(n),S.append(w),k.name?C.$broadcast("ngDialog.opened",{dialog:w,name:k.name}):C.$broadcast("ngDialog.opened",w)}),k.closeByEscape&&h.bind("keydown",$.onDocumentKeydown),k.closeByNavigation&&C.$on("$locationChangeSuccess",function(){$.closeDialog(w)}),l=function(e){var o=k.closeByDocument?a(e.target).hasClass("ngdialog-overlay"):!1,n=a(e.target).hasClass("ngdialog-close");(o||n)&&b.close(w.attr("id"),n?"$closeButton":"$document")},"undefined"!=typeof v.Hammer){var d=o.hammerTime=v.Hammer(w[0]);d.on("tap",l)}else w.bind("click",l);return r+=1,b}),{id:"ngdialog"+i,closePromise:B.promise,close:function(e){$.closeDialog(w,e)}}},openConfirm:function(o){var n=m.defer(),l={closeByEscape:!1,closeByDocument:!1};e.extend(l,o),l.scope=e.isObject(l.scope)?l.scope.$new():C.$new(),l.scope.confirm=function(e){n.resolve(e);var o=a(document.getElementById(i.id));$.performCloseDialog(o,e)};var i=b.open(l);return i.closePromise.then(function(e){return e?n.reject(e.value):n.reject()}),n.promise},close:function(e,o){var n=a(document.getElementById(e));return n.length?$.closeDialog(n,o):b.closeAll(o),b},closeAll:function(o){var n=document.querySelectorAll(".ngdialog");e.forEach(n,function(e){$.closeDialog(a(e),o)})},getDefaults:function(){return n}};return b}]}),n.directive("ngDialog",["ngDialog",function(o){return{restrict:"A",scope:{ngDialogScope:"="},link:function(n,a,l){a.on("click",function(a){a.preventDefault();var i=e.isDefined(n.ngDialogScope)?n.ngDialogScope:"noScope";e.isDefined(l.ngDialogClosePrevious)&&o.close(l.ngDialogClosePrevious);var t=o.getDefaults();o.open({template:l.ngDialog,className:l.ngDialogClass||t.className,controller:l.ngDialogController,scope:i,data:l.ngDialogData,showClose:"false"===l.ngDialogShowClose?!1:"true"===l.ngDialogShowClose?!0:t.showClose,closeByDocument:"false"===l.ngDialogCloseByDocument?!1:"true"===l.ngDialogCloseByDocument?!0:t.closeByDocument,closeByEscape:"false"===l.ngDialogCloseByEscape?!1:"true"===l.ngDialogCloseByEscape?!0:t.closeByEscape,preCloseCallback:l.ngDialogPreCloseCallback||t.preCloseCallback})})}}}]),n});