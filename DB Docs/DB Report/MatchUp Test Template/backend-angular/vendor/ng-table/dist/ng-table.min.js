!function(t,e){"use strict";return"function"==typeof define&&define.amd?void define(["angular"],function(t){return e(t)}):e(t)}(angular||null,function(t){"use strict";var e=t.module("ngTable",[]);return e.value("ngTableDefaults",{params:{},settings:{}}),e.factory("NgTableParams",["$q","$log","ngTableDefaults",function(e,a,n){var r=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},i=function(i,s){var l=this,o=function(){c.debugMode&&a.debug&&a.debug.apply(this,arguments)};this.data=[],this.parameters=function(e,a){if(a=a||!1,t.isDefined(e)){for(var n in e){var i=e[n];if(a&&n.indexOf("[")>=0){for(var s=n.split(/\[(.*)\]/).reverse(),l="",c=0,p=s.length;p>c;c++){var g=s[c];if(""!==g){var m=i;i={},i[l=g]=r(m)?parseFloat(m):m}}"sorting"===l&&(u[l]={}),u[l]=t.extend(u[l]||{},i[l])}else u[n]=r(e[n])?parseFloat(e[n]):e[n]}return o("ngTable: set parameters",u),this}return u},this.settings=function(e){return t.isDefined(e)?(t.isArray(e.data)&&(e.total=e.data.length),c=t.extend(c,e),o("ngTable: set settings",c),this):c},this.page=function(e){return t.isDefined(e)?this.parameters({page:e}):u.page},this.total=function(e){return t.isDefined(e)?this.settings({total:e}):c.total},this.count=function(e){return t.isDefined(e)?this.parameters({count:e,page:1}):u.count},this.filter=function(e){return t.isDefined(e)?this.parameters({filter:e,page:1}):u.filter},this.sorting=function(e){if(2==arguments.length){var a={};return a[e]=arguments[1],this.parameters({sorting:a}),this}return t.isDefined(e)?this.parameters({sorting:e}):u.sorting},this.isSortBy=function(e,a){return t.isDefined(u.sorting[e])&&t.equals(u.sorting[e],a)},this.orderBy=function(){var t=[];for(var e in u.sorting)t.push(("asc"===u.sorting[e]?"+":"-")+e);return t},this.getData=function(e,a){return e.resolve(t.isArray(this.data)&&t.isObject(a)?this.data.slice((a.page()-1)*a.count(),a.page()*a.count()):[]),e.promise},this.getGroups=function(a,n){var r=e.defer();return r.promise.then(function(e){var r={};t.forEach(e,function(e){var a=t.isFunction(n)?n(e):e[n];r[a]=r[a]||{data:[]},r[a].value=a,r[a].data.push(e)});var i=[];for(var s in r)i.push(r[s]);o("ngTable: refresh groups",i),a.resolve(i)}),this.getData(r,l)},this.generatePagesArray=function(t,e,a){var n,r,i,s,l,o;if(n=11,o=[],l=Math.ceil(e/a),l>1){o.push({type:"prev",number:Math.max(1,t-1),active:t>1}),o.push({type:"first",number:1,active:t>1,current:1===t}),i=Math.round((n-5)/2),s=Math.max(2,t-i),r=Math.min(l-1,t+2*i-(t-s)),s=Math.max(2,s-(2*i-(r-s)));for(var u=s;r>=u;)o.push(u===s&&2!==u||u===r&&u!==l-1?{type:"more",active:!1}:{type:"page",number:u,active:t!==u,current:t===u}),u++;o.push({type:"last",number:l,active:t!==l,current:t===l}),o.push({type:"next",number:Math.min(l,t+1),active:l>t})}return o},this.url=function(e){e=e||!1;var a=e?[]:{};for(var n in u)if(u.hasOwnProperty(n)){var r=u[n],i=encodeURIComponent(n);if("object"==typeof r){for(var s in r)if(!t.isUndefined(r[s])&&""!==r[s]){var l=i+"["+encodeURIComponent(s)+"]";e?a.push(l+"="+r[s]):a[l]=r[s]}}else t.isFunction(r)||t.isUndefined(r)||""===r||(e?a.push(i+"="+encodeURIComponent(r)):a[i]=encodeURIComponent(r))}return a},this.reload=function(){var t=e.defer(),a=this,n=null;return c.$scope?(c.$loading=!0,n=c.groupBy?c.getGroups(t,c.groupBy,this):c.getData(t,this),o("ngTable: reload data"),n||(n=t.promise),n.then(function(t){return c.$loading=!1,o("ngTable: current scope",c.$scope),c.groupBy?(a.data=t,c.$scope&&(c.$scope.$groups=t)):(a.data=t,c.$scope&&(c.$scope.$data=t)),c.$scope&&(c.$scope.pages=a.generatePagesArray(a.page(),a.total(),a.count())),c.$scope.$emit("ngTableAfterReloadData"),t})):void 0},this.reloadPages=function(){var t=this;c.$scope.pages=t.generatePagesArray(t.page(),t.total(),t.count())};var u=this.$params={page:1,count:1,filter:{},sorting:{},group:{},groupBy:null};t.extend(u,n.params);var c={$scope:null,$loading:!1,data:null,total:0,defaultSort:"desc",filterDelay:750,counts:[10,25,50,100],getGroups:this.getGroups,getData:this.getData};return t.extend(c,n.settings),this.settings(s),this.parameters(i,!0),this};return i}]),e.factory("ngTableParams",["NgTableParams",function(t){return t}]),e.controller("ngTableController",["$scope","NgTableParams","$timeout","$parse","$compile","$attrs","$element","ngTableColumn",function(e,a,n,r,i,s,l,o){function u(){e.params.$params.page=1}var c=!0;e.$filterRow={},e.$loading=!1,e.hasOwnProperty("params")||(e.params=new a,e.params.isNullInstance=!0),e.params.settings().$scope=e;var p=function(){var t=0;return function(e,a){n.cancel(t),t=n(e,a)}}();e.$watch("params.$params",function(a,n){if(a!==n){if(e.params.settings().$scope=e,t.equals(a.filter,n.filter))e.params.reload();else{var r=c?t.noop:u;p(function(){r(),e.params.reload()},e.params.settings().filterDelay)}e.params.isNullInstance||(c=!1)}},!0),this.compileDirectiveTemplates=function(){if(!l.hasClass("ng-table")){e.templates={header:s.templateHeader?s.templateHeader:"ng-table/header.html",pagination:s.templatePagination?s.templatePagination:"ng-table/pager.html"},l.addClass("ng-table");var a=null;0===l.find("> thead").length&&(a=t.element(document.createElement("thead")).attr("ng-include","templates.header"),l.prepend(a));var n=t.element(document.createElement("div")).attr({"ng-table-pagination":"params","template-url":"templates.pagination"});l.after(n),a&&i(a)(e),i(n)(e)}},this.loadFilterData=function(a){t.forEach(a,function(a){var n;return n=a.filterData(e,{$column:a}),n?t.isObject(n)&&t.isObject(n.promise)?(delete a.filterData,n.promise.then(function(e){t.isArray(e)||t.isFunction(e)||t.isObject(e)?t.isArray(e)&&e.unshift({title:"-",id:""}):e=[],a.data=e})):a.data=n:void delete a.filterData})},this.buildColumns=function(t){return t.map(function(t){return o.buildColumn(t,e)})},this.setupBindingsToInternalScope=function(a){var n=r(a);e.$watch(n,function(a){t.isUndefined(a)||(e.paramsModel=n,e.params=a)},!1),s.showFilter&&e.$parent.$watch(s.showFilter,function(t){e.show_filter=t}),s.disableFilter&&e.$parent.$watch(s.disableFilter,function(t){e.$filterRow.disabled=t})},e.sortBy=function(t,a){var n=t.sortable&&t.sortable();if(n){var r=e.params.settings().defaultSort,i="asc"===r?"desc":"asc",s=e.params.sorting()&&e.params.sorting()[n]&&e.params.sorting()[n]===r,l=a.ctrlKey||a.metaKey?e.params.sorting():{};l[n]=s?i:r,e.params.parameters({sorting:l})}}}]),e.factory("ngTableColumn",[function(){function e(e,n){var r=Object.create(e);for(var i in a)void 0===r[i]&&(r[i]=a[i]),t.isFunction(r[i])||!function(t){r[t]=function(){return e[t]}}(i),function(t){var a=r[t];r[t]=function(){return 0===arguments.length?a.call(e,n):a.apply(e,arguments)}}(i);return r}var a={"class":function(){return""},filter:function(){return!1},filterData:t.noop,headerTemplateURL:function(){return!1},headerTitle:function(){return" "},sortable:function(){return!1},show:function(){return!0},title:function(){return" "},titleAlt:function(){return""}};return{buildColumn:e}}]),e.directive("ngTable",["$q","$parse",function(e,a){return{restrict:"A",priority:1001,scope:!0,controller:"ngTableController",compile:function(e){var n=[],r=0,i=null;return t.forEach(t.element(e.find("tr")),function(e){e=t.element(e),e.hasClass("ng-table-group")||i||(i=e)}),i?(t.forEach(i.find("td"),function(e){var i=t.element(e);if(!i.attr("ignore-cell")||"true"!==i.attr("ignore-cell")){var s=function(t){return i.attr("x-data-"+t)||i.attr("data-"+t)||i.attr(t)},l=function(e){var r=s(e);return r?function(e,i){return a(r)(e,t.extend(i||{},{$columns:n}))}:void 0},o=s("title-alt")||s("title");o&&i.attr("data-title-text","{{"+o+"}}"),n.push({id:r++,title:l("title"),titleAlt:l("title-alt"),headerTitle:l("header-title"),sortable:l("sortable"),"class":l("header-class"),filter:l("filter"),headerTemplateURL:l("header"),filterData:l("filter-data"),show:i.attr("ng-show")?function(t){return a(i.attr("ng-show"))(t)}:void 0})}}),function(t,e,a,r){t.$columns=n=r.buildColumns(n),r.setupBindingsToInternalScope(a.ngTable),r.loadFilterData(n),r.compileDirectiveTemplates()}):void 0}}}]),e.directive("ngTableDynamic",["$parse",function(e){function a(t){if(!t||t.indexOf(" with ")>-1){var e=t.split(/\s+with\s+/);return{tableParams:e[0],columns:e[1]}}throw new Error("Parse error (expected example: ng-table-dynamic='tableParams with cols')")}return{restrict:"A",priority:1001,scope:!0,controller:"ngTableController",compile:function(n){var r;return t.forEach(t.element(n.find("tr")),function(e){e=t.element(e),e.hasClass("ng-table-group")||r||(r=e)}),r?(t.forEach(r.find("td"),function(e){var a=t.element(e),n=function(t){return a.attr("x-data-"+t)||a.attr("data-"+t)||a.attr(t)},r=n("title");r||a.attr("data-title-text","{{$columns[$index].titleAlt(this) || $columns[$index].title(this)}}");var i=a.attr("ng-show");i||a.attr("ng-show","$columns[$index].show(this)")}),function(t,n,r,i){var s=a(r.ngTableDynamic),l=e(s.columns)(t)||[];t.$columns=i.buildColumns(l),i.setupBindingsToInternalScope(s.tableParams),i.loadFilterData(t.$columns),i.compileDirectiveTemplates()}):void 0}}}]),e.directive("ngTablePagination",["$compile",function(e){return{restrict:"A",scope:{params:"=ngTablePagination",templateUrl:"="},replace:!1,link:function(a,n){a.params.settings().$scope.$on("ngTableAfterReloadData",function(){a.pages=a.params.generatePagesArray(a.params.page(),a.params.total(),a.params.count())},!0),a.$watch("templateUrl",function(r){if(!t.isUndefined(r)){var i=t.element(document.createElement("div"));i.attr({"ng-include":"templateUrl"}),n.append(i),e(i)(a)}})}}}]),t.module("ngTable").run(["$templateCache",function(t){t.put("ng-table/filters/select-multiple.html",'<select ng-options="data.id as data.title for data in $column.data" ng-disabled="$filterRow.disabled" multiple ng-multiple="true" ng-model="params.filter()[name]" ng-show="filter==\'select-multiple\'" class="filter filter-select-multiple form-control" name="{{name}}"> </select>'),t.put("ng-table/filters/select.html",'<select ng-options="data.id as data.title for data in $column.data" ng-disabled="$filterRow.disabled" ng-model="params.filter()[name]" ng-show="filter==\'select\'" class="filter filter-select form-control" name="{{name}}"> </select>'),t.put("ng-table/filters/text.html",'<input type="text" name="{{name}}" ng-disabled="$filterRow.disabled" ng-model="params.filter()[name]" ng-if="filter==\'text\'" class="input-filter form-control"/>'),t.put("ng-table/header.html",'<tr> <th title="{{$column.headerTitle(this)}}" ng-repeat="$column in $columns" ng-class="{ \'sortable\': $column.sortable(this), \'sort-asc\': params.sorting()[$column.sortable(this)]==\'asc\', \'sort-desc\': params.sorting()[$column.sortable(this)]==\'desc\' }" ng-click="sortBy($column, $event)" ng-show="$column.show(this)" ng-init="template=$column.headerTemplateURL(this)" class="header {{$column.class(this)}}"> <div ng-if="!template" ng-show="!template" ng-bind="$column.title(this)"></div> <div ng-if="template" ng-show="template" ng-include="template"></div> </th> </tr> <tr ng-show="show_filter" class="ng-table-filters"> <th data-title-text="{{$column.titleAlt(this) || $column.title(this)}}" ng-repeat="$column in $columns" ng-show="$column.show(this)" class="filter"> <div ng-repeat="(name, filter) in $column.filter(this)"> <div ng-if="filter.indexOf(\'/\') !==-1" ng-include="filter"></div> <div ng-if="filter.indexOf(\'/\')===-1" ng-include="\'ng-table/filters/\' + filter + \'.html\'"></div> </div> </th> </tr> '),t.put("ng-table/pager.html",'<div class="ng-cloak ng-table-pager" ng-if="params.data.length"> <div ng-if="params.settings().counts.length" class="ng-table-counts btn-group pull-right"> <button ng-repeat="count in params.settings().counts" type="button" ng-class="{\'active\':params.count()==count}" ng-click="params.count(count)" class="btn btn-default"> <span ng-bind="count"></span> </button> </div> <ul class="pagination ng-table-pagination"> <li ng-class="{\'disabled\': !page.active && !page.current, \'active\': page.current}" ng-repeat="page in pages" ng-switch="page.type"> <a ng-switch-when="prev" ng-click="params.page(page.number)" href="">&laquo;</a> <a ng-switch-when="first" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a> <a ng-switch-when="page" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a> <a ng-switch-when="more" ng-click="params.page(page.number)" href="">&#8230;</a> <a ng-switch-when="last" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a> <a ng-switch-when="next" ng-click="params.page(page.number)" href="">&raquo;</a> </li> </ul> </div> ')}]),e});