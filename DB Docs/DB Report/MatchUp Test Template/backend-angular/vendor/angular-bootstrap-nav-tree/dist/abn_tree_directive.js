(function(){var n,e=[].indexOf||function(n){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===n)return e;return-1};n=angular.module("angularBootstrapNavTree",[]),n.directive("abnTree",["$timeout",function(n){return{restrict:"E",template:'<ul class="nav nav-list nav-pills nav-stacked abn-tree">\n  <li ng-repeat="row in tree_rows | filter:{visible:true} track by row.branch.uid" ng-animate="\'abn-tree-animate\'" ng-class="\'level-\' + {{ row.level }} + (row.branch.selected ? \' active\':\'\') + \' \' +row.classes.join(\' \')" class="abn-tree-row"><a ng-click="user_clicks_branch(row.branch)"><i ng-class="row.tree_icon" ng-click="row.branch.expanded = !row.branch.expanded" class="indented tree-icon"> </i><span class="indented tree-label">{{ row.label }} </span></a></li>\n</ul>',replace:!0,scope:{treeData:"=",onSelect:"&",initialSelection:"@",treeControl:"="},link:function(r,t,l){var i,a,c,u,o,s,d,h,_,f,g;if(i=function(n){return void console.log("ERROR:"+n)},null==l.iconExpand&&(l.iconExpand="icon-plus  glyphicon glyphicon-plus  fa fa-plus"),null==l.iconCollapse&&(l.iconCollapse="icon-minus glyphicon glyphicon-minus fa fa-minus"),null==l.iconLeaf&&(l.iconLeaf="icon-file  glyphicon glyphicon-file  fa fa-file"),null==l.expandLevel&&(l.expandLevel="3"),c=parseInt(l.expandLevel,10),!r.treeData)return void alert("no treeData defined for the tree!");if(null==r.treeData.length){if(null==treeData.label)return void alert("treeData should be an array of root branches");r.treeData=[treeData]}return o=function(n){var e,t,l,i,a,c;for(e=function(r,t){var l,i,a,c,u;if(n(r,t),null!=r.children){for(c=r.children,u=[],i=0,a=c.length;a>i;i++)l=c[i],u.push(e(l,t+1));return u}},a=r.treeData,c=[],l=0,i=a.length;i>l;l++)t=a[l],c.push(e(t,1));return c},f=null,_=function(e){if(!e)return null!=f&&(f.selected=!1),void(f=null);if(e!==f){if(null!=f&&(f.selected=!1),e.selected=!0,f=e,a(e),null!=e.onSelect)return n(function(){return e.onSelect(e)});if(null!=r.onSelect)return n(function(){return r.onSelect({branch:e})})}},r.user_clicks_branch=function(n){return n!==f?_(n):void 0},s=function(n){var e;return e=void 0,n.parent_uid&&o(function(r){return r.uid===n.parent_uid?e=r:void 0}),e},u=function(n,e){var r;return r=s(n),null!=r?(e(r),u(r,e)):void 0},a=function(n){return u(n,function(n){return n.expanded=!0})},r.tree_rows=[],h=function(){var n,t,i,a,c,u;for(o(function(n){return n.uid?void 0:n.uid=""+Math.random()}),console.log("UIDs are set."),o(function(n){var e,r,t,l,i;if(angular.isArray(n.children)){for(l=n.children,i=[],r=0,t=l.length;t>r;r++)e=l[r],i.push(e.parent_uid=n.uid);return i}}),r.tree_rows=[],o(function(n){var e,r;return n.children?n.children.length>0?(r=function(n){return"string"==typeof n?{label:n,children:[]}:n},n.children=function(){var t,l,i,a;for(i=n.children,a=[],t=0,l=i.length;l>t;t++)e=i[t],a.push(r(e));return a}()):void 0:n.children=[]}),n=function(t,i,a){var c,u,o,s,d,h,_;if(null==i.expanded&&(i.expanded=!1),null==i.classes&&(i.classes=[]),i.noLeaf||i.children&&0!==i.children.length?o=i.expanded?l.iconCollapse:l.iconExpand:(o=l.iconLeaf,e.call(i.classes,"leaf")<0&&i.classes.push("leaf")),r.tree_rows.push({level:t,branch:i,label:i.label,classes:i.classes,tree_icon:o,visible:a}),null!=i.children){for(h=i.children,_=[],s=0,d=h.length;d>s;s++)c=h[s],u=a&&i.expanded,_.push(n(t+1,c,u));return _}},c=r.treeData,u=[],i=0,a=c.length;a>i;i++)t=c[i],u.push(n(1,t,!0));return u},r.$watch("treeData",h,!0),null!=l.initialSelection&&o(function(e){return e.label===l.initialSelection?n(function(){return _(e)}):void 0}),d=r.treeData.length,console.log("num root branches = "+d),o(function(n,e){return n.level=e,n.expanded=n.level<c}),null!=r.treeControl&&angular.isObject(r.treeControl)?(g=r.treeControl,g.expand_all=function(){return o(function(n){return n.expanded=!0})},g.collapse_all=function(){return o(function(n){return n.expanded=!1})},g.get_first_branch=function(){return d=r.treeData.length,d>0?r.treeData[0]:void 0},g.select_first_branch=function(){var n;return n=g.get_first_branch(),g.select_branch(n)},g.get_selected_branch=function(){return f},g.get_parent_branch=function(n){return s(n)},g.select_branch=function(n){return _(n),n},g.get_children=function(n){return n.children},g.select_parent_branch=function(n){var e;return null==n&&(n=g.get_selected_branch()),null!=n&&(e=g.get_parent_branch(n),null!=e)?(g.select_branch(e),e):void 0},g.add_branch=function(n,e){return null!=n?(n.children.push(e),n.expanded=!0):r.treeData.push(e),e},g.add_root_branch=function(n){return g.add_branch(null,n),n},g.expand_branch=function(n){return null==n&&(n=g.get_selected_branch()),null!=n?(n.expanded=!0,n):void 0},g.collapse_branch=function(n){return null==n&&(n=f),null!=n?(n.expanded=!1,n):void 0},g.get_siblings=function(n){var e,t;return null==n&&(n=f),null!=n?(e=g.get_parent_branch(n),t=e?e.children:r.treeData):void 0},g.get_next_sibling=function(n){var e,r;return null==n&&(n=f),null!=n&&(r=g.get_siblings(n),d=r.length,e=r.indexOf(n),d>e)?r[e+1]:void 0},g.get_prev_sibling=function(n){var e,r;return null==n&&(n=f),r=g.get_siblings(n),d=r.length,e=r.indexOf(n),e>0?r[e-1]:void 0},g.select_next_sibling=function(n){var e;return null==n&&(n=f),null!=n&&(e=g.get_next_sibling(n),null!=e)?g.select_branch(e):void 0},g.select_prev_sibling=function(n){var e;return null==n&&(n=f),null!=n&&(e=g.get_prev_sibling(n),null!=e)?g.select_branch(e):void 0},g.get_first_child=function(n){var e;return null==n&&(n=f),null!=n&&(null!=(e=n.children)?e.length:void 0)>0?n.children[0]:void 0},g.get_closest_ancestor_next_sibling=function(n){var e,r;return e=g.get_next_sibling(n),null!=e?e:(r=g.get_parent_branch(n),g.get_closest_ancestor_next_sibling(r))},g.get_next_branch=function(n){var e;return null==n&&(n=f),null!=n?(e=g.get_first_child(n),null!=e?e:e=g.get_closest_ancestor_next_sibling(n)):void 0},g.select_next_branch=function(n){var e;return null==n&&(n=f),null!=n&&(e=g.get_next_branch(n),null!=e)?(g.select_branch(e),e):void 0},g.last_descendant=function(n){var e;return d=n.children.length,0===d?n:(e=n.children[d-1],g.last_descendant(e))},g.get_prev_branch=function(n){var e,r;return null==n&&(n=f),null!=n?(r=g.get_prev_sibling(n),null!=r?g.last_descendant(r):e=g.get_parent_branch(n)):void 0},g.select_prev_branch=function(n){var e;return null==n&&(n=f),null!=n&&(e=g.get_prev_branch(n),null!=e)?(g.select_branch(e),e):void 0}):void 0}}}])}).call(this);